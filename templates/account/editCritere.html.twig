{% extends 'base.html.twig' %}

{% block title %}Hello AccountController!{% endblock %}
{% block stylesheets %}
<style>


  .form-group>label{
  font-weight : 400 ;
  margin-bottom : 0px;
  font-size : 12px;
  }
		.form-group > label.error {
			display: block !important;
			text-transform: none;
		}

		.form-group input.valid ~ label.error,
		.form-group input[type="text"] ~ label.error,
		.form-group input[type="email"] ~ label.error,
		.form-group input[type="number"] ~ label.error,
		.form-group select ~ label.error { display: none !important; }
</style>
{% endblock %}

{% form_theme form '/_collection.html.twig' %}

{% block body %}
<link rel="stylesheet" type="text/css" id="u0" href="/js/components/tinymce/skins/ui/oxide/skin.min.css">
{% set cv = user.candidat.cv %}
{% set critere = user.candidat.critere %}
    <section id="content">
			<div class="content-wrap">
				<div class="container clearfix">

					<div class="row clearfix">
            {# <img src="{{user.candidat.picture}}" class="alignleft img-circle img-thumbnail my-0" alt="Avatar" style="max-width: 84px;"> #}

							<div class="row clearfix">

              <div class="col-md-9">

                <img src="{{user.candidat.picture}}" class="alignleft img-circle img-thumbnail my-0" alt="Avatar" style="max-width: 84px;">

                <div class="heading-block border-0">
                  <h3>{{user.firstName}} {{user.lastName}} </h3>
                  <span>{{user.numTel}}</span>
                </div>

                <div class="clear"></div>
            <div class="title-block">
              <h2>Mes critères de recherche</h2>
            </div>
              <div class="content shadow bg-light border px-5 py-md-3">

                {{ form_start(form) }}
                  <div class="form-row">
                    <div class="col-10 form-group">
                      {{ form_row(form.disponiblilite)  }}
                    </div>
                  </div>
                  {{ form_label(form.secteurActivites) }}
                  <div class="form-row">
                  {% for secteur in form.secteurActivites %}
                    <div class="col-6 form-group">
                      {{ form_widget(secteur)  }}
                      {{ form_label(secteur ) }}
                    </div>
                  {% endfor %}
                  </div>
                  {{ form_label(form.metier) }}
                  <div class="form-row">
                    <div class="col-12 form-group">
                      {{ form_widget(form.metier,{'attr' :{'class' : 'selectpicker',
                                                            'data-width' : '400px'}}) }}
                    </div>
                  </div>
                  {{ form_label(form.langues) }}
                  <div class="form-row">
                    <div class="col-12 form-group">
                      {{ form_widget(form.langues,{'attr' :{'class' : 'selectpicker',
                                                            'data-width' : '400px',
                                                            'data-max-options': '5'}}) }}
                    </div>
                  </div>
                  {{ form_label(form.typeContrats,) }}
                  <div class="form-row">
                      {% for secteur in form.typeContrats %}
                    <div class="col-2 form-group">
                      {{ form_widget(secteur)  }}
                      {{ form_label(secteur ) }}
                    </div>
                  {% endfor %}

                  </div>
                  <div class="form-row">
                      {% for secteur in form.mobilites %}
                    <div class="col-3 form-group">
                      {{ form_widget(secteur)  }}
                      {{ form_label(secteur ) }}
                    </div>
                  {% endfor %}

                  </div>
                  <div class="form-row">
                    <div class="col-3 form-group">
                      {{ form_row(form.renumeration)  }}
                    </div>
                  </div>
                  <button type="submit" class="button button-border">Completez !</button>
                {{ form_end(form) }}
              </div>

						</div>

						<div class="w-100 line d-block d-md-none"></div>

						<div class="col-md-3">

							<div class="list-group">
								<a href="{{ path('my_account') }}" class="list-group-item list-group-item-action d-flex justify-content-between"><div>Profile</div><i class="icon-user"></i></a>
								<a href="{{ path('edit_cv') }}" class="list-group-item list-group-item-action d-flex justify-content-between"><div>Edition du Cv</div><i class="icon-laptop2"></i></a>
								<a href="{{ path('edit_critere') }}" class="list-group-item list-group-item-action d-flex justify-content-between"><div>Mes Critères de Recherche</div><i class="icon-envelope2"></i></a>
								<a href="#" class="list-group-item list-group-item-action d-flex justify-content-between"><div>Billing</div><i class="icon-credit-cards"></i></a>
								<a href="{{ path('edit_profil') }}" class="list-group-item list-group-item-action d-flex justify-content-between"><div>Settings</div><i class="icon-cog"></i></a>
								<a href="{{ path('account_logout') }}" class="list-group-item list-group-item-action d-flex justify-content-between"><div>Logout</div><i class="icon-line2-logout"></i></a>
							</div>

							<div class="fancy-title topmargin title-border">
								<h4>About Me</h4>
							</div>

							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsum laboriosam, dignissimos veniam obcaecati. Quasi eaque, odio assumenda porro explicabo laborum!</p>

							<div class="fancy-title topmargin title-border">
								<h4>Social Profiles</h4>
							</div>

							<a href="#" class="social-icon si-facebook si-small si-rounded si-light" title="Facebook">
								<i class="icon-facebook"></i>
								<i class="icon-facebook"></i>
							</a>

							<a href="#" class="social-icon si-gplus si-small si-rounded si-light" title="Google+">
								<i class="icon-gplus"></i>
								<i class="icon-gplus"></i>
							</a>

							<a href="#" class="social-icon si-dribbble si-small si-rounded si-light" title="Dribbble">
								<i class="icon-dribbble"></i>
								<i class="icon-dribbble"></i>
							</a>

							<a href="#" class="social-icon si-flickr si-small si-rounded si-light" title="Flickr">
								<i class="icon-flickr"></i>
								<i class="icon-flickr"></i>
							</a>

							<a href="#" class="social-icon si-linkedin si-small si-rounded si-light" title="LinkedIn">
								<i class="icon-linkedin"></i>
								<i class="icon-linkedin"></i>
							</a>

							<a href="#" class="social-icon si-twitter si-small si-rounded si-light" title="Twitter">
								<i class="icon-twitter"></i>
								<i class="icon-twitter"></i>
							</a>

						</div>

					</div>

				</div>
			</div>
		</section>

{% endblock %}
{% block javascripts %}
<script>



		jQuery(document).ready( function(){

			let pricingResponsive = 0,
				pricingRetina = 0,
				pricingWebtype = 0,
				pricingDesign = 0,
				pricingPages = 0,
				pricingCMS = 0,
				pricingSEO = 1,
				pricingGA = 0,
				pricingUrgent = 0,
				elementPrice = $("#website-cost-price"),
				elementResponsive = $( 'input[name="website-cost-responsive"]' ),
				elementRetina = $( 'input[name="website-cost-retina"]' ),
				elementWebType = $( 'input[name="website-cost-type"]' ),
				elementDesign = $( 'input[name="website-cost-design"]' ),
				elementPages = $(".website-pages"),
				elementCMS = $("input[name='website-cost-cms']"),
				elementGA = $("input[name='website-cost-google-analytics']"),
				elementUrgent = $("input[name='website-cost-before-30-days']"),
				elementSEO = $(".website-seo");
         $('.datepicker').datepicker({
                        autoclose: true
                    });

                    $('#feedback-form').on( 'formSubmitSuccess', function(){
                        $('.feedback-form-success-modal').magnificPopup('open');
                    });

			elementResponsive.on( 'change', function(){
				pricingResponsive = $(this).attr('data-price');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementRetina.on( 'change', function(){
				pricingRetina = $(this).attr('data-price');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementWebType.on( 'change', function(){
				pricingWebtype = $(this).attr('data-price');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementDesign.on( 'change', function(){
				pricingDesign = $(this).attr('data-price');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementPages.ionRangeSlider({
				min: 10,
				max: 100,
				from: 10,
				step: 10,
				max_postfix: "+",
				onStart: function(data){
					pricingPages = data.from;
				}
			});

			elementPages.on( 'change', function(){
				pricingPages = $(this).prop('value');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementCMS.on( 'change', function(){
				pricingCMS = $(this).attr('data-price');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementSEO.ionRangeSlider({
				min: 0,
				max: 210,
				from: 0,
				step: 30,
				max_postfix: " Keywords",
				onStart: function(data){
					pricingSEO = data.from;
				}
			});

			elementSEO.on( 'onStart change', function(){
				pricingSEO = $(this).prop('value');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementGA.on( 'change', function(){
				pricingGA = $(this).attr('data-price');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			elementUrgent.on( 'change', function(){
				pricingUrgent = $(this).attr('data-price');
				calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );
			});

			calculatePrice( pricingResponsive, pricingRetina, pricingWebtype, pricingDesign, pricingPages, pricingCMS, pricingSEO, pricingGA, pricingUrgent );

			function calculatePrice( responsive, retina, webtype, design, pages, cms, seo, ga, urgent ) {
				let TotalPriceValue = Number(responsive) + Number(retina) + Number(webtype) + Number(design) + ( Number(pages) * 100 ) + Number(cms) + ( Number(seo) * 100 ) + Number(ga) + Number(urgent);
				jQuery('.responsive-value').html( '$'+pricingResponsive );
				jQuery('.retina-value').html( '$'+pricingRetina );
				jQuery('.website-type-value').html( '$'+pricingWebtype );
				jQuery('.design-value').html( '$'+pricingDesign );
				jQuery('.pages-value').html('$'+pricingPages * 100);
				jQuery('.cms-value').html('$'+pricingCMS);
				jQuery('.seo-value').html('$'+pricingSEO  * 100);
				jQuery('.google-analytics-value').html('$'+pricingGA);
				jQuery('.urgent-value').html('$'+pricingUrgent);
				jQuery('.total-price').html( '$'+TotalPriceValue );
				elementPrice.val( TotalPriceValue ).change();
			}

			$('#website-cost').on( 'formSubmitSuccess', function(){
				$('.responsive-value, .retina-value, .website-type-value, .design-value, .pages-value, .cms-value, .google-analytics-value, .urgent-value, .total-price' ).html( '$0' );
			});

			tinymce.init({
				selector: '#website-cost-message',
				menubar: false,
				setup: function(editor) {
					editor.on('change', function(e) {
						editor.save();
					});
				}
			});

		});

    $("#freelance-quote-sample").fileinput({
				browseClass: "btn btn-secondary",
				browseIcon: "",
				removeClass: "btn btn-danger",
				removeLabel: "",
				removeIcon: "<i class='icon-trash-alt1'></i>",
				showUpload: false
			});


	$('#cv-formation').click(function(){
      // je recupère le numéro des futures champs que je vais creer
      const index = +$('#widgets-counter').val();

      // Je recupère le prototype des entrées
      const tmpl =  $('#cv_formations').data('prototype').replace(/__name__/g, index);

      //j'injecte ce code au sein de la div
      $('#cv_formations').append(tmpl);

      $('#widgets-counter').val(index + 1);

      //je gére la suppression d'image
      handleDeleteButtons();
    });

    function updateCounterFormation(){
      const count = +$('#cv_formations div.form-group').length;

      $('#widgets-counter').val(count);
    }

	$('#cv-experience').click(function(){
      // je recupère le numéro des futures champs que je vais creer
      const index = +$('#widgets-counter_1').val();

      // Je recupère le prototype des entrées
      const tmpl =  $('#cv_experiences').data('prototype').replace(/__name__/g, index);

      //j'injecte ce code au sein de la div
      $('#cv_experiences').append(tmpl);

      $('#widgets-counter_1').val(index + 1);

      //je gére la suppression d'image
      handleDeleteButtons();
    });

    function updateCounterExperience(){
      const count = +$('#cv_experiences div.form-group').length;

      $('#widgets-counter_1').val(count);
    }

    function handleDeleteButtons(){
      $('button[data-action="delete"]').click(function(){
        const target = this.dataset.target;
        $(target).remove();
      });
    }


    updateCounterFormation();
    updateCounterExperience();

    handleDeleteButtons();
</script>
{% endblock %}
